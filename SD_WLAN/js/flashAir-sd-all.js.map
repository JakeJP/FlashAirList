{"version":3,"sources":["flashAir-sd-all.js","flashAirSynchronizer.ts","yokins-fa.ts"],"names":["__extends","this","d","b","__","constructor","p","hasOwnProperty","prototype","FlashAir","FlashAir.SyncScheme","FlashAir.SyncMode","FlashAir.QueueStatus","FlashAir.SyncStatus","FlashAir.DirectoryStatus","FlashAir.FlashAirSynchronizer","FlashAir.FlashAirSynchronizer.constructor","FlashAir.FlashAirSynchronizer.selectLocalHomeDirectory","FlashAir.FlashAirSynchronizer.fileListUpaded","FlashAir.FlashAirSynchronizer.startMonitoring","FlashAir.FlashAirSynchronizer.stopMonitoring","FlashAir.FlashAirSynchronizer.start","FlashAir.FlashAirSynchronizer.stop","FlashAir.FlashAirSynchronizer.startNext","me","trigger","faItem","loaded","total","_syncStatus","runningItem","fa","resumePolling","start","FlashAir.FlashAirSynchronizer.queue","FlashAir.FlashAirSynchronizer.unqueue","FlashAir.FlashAirSynchronizer.downloadFile","FlashAir.SyncQueue","FlashAir.SyncQueue.constructor","FlashAir.SyncQueue.next","FlashAir.SyncQueue.add","FlashAir.SyncQueue.remove","PhotoSwipe","PhotoSwipeUI_Default","filesize","moment","is_chrome_app","document","location","protocol","is_ms_app","is_app","wlansd","faClient","FlashAirApp","FlashAirApp.constructor","onHostChanged","onHostReady","pollingStatusChanged","status","actionRefresh","clearTimeout","_timeout","setTimeout","recalcImageLoading","FlashAirApp.initializeApp","FlashAirApp.initUi","btn","$","menu","parent","sortAscending","hasClass","data","grid","isotope","sortBy","removeClass","addClass","a","href","attr","navigate","e","preventDefault","m","hashDir","exec","hash","console","log","FlashAirApp.onHostChanged","FlashAirApp.onHostReady","FlashAirApp.pushHistory","FlashAirApp.navigate","FlashAirApp.recalcImageLoading","el","element","et","offset","top","eb","height","is","find","wt","margin","wb","FlashAirApp.setWindowTitle","FlashAirApp.pollingStatusChanged","FlashAirApp.actionRefresh","setWindowTitle","dir","refreshList","list","isNavigation","FlashAirApp.deleteItemFromList","FlashAirApp.clearList","deleteItemFromList","i","FlashAirApp.refreshList","_checked","key","r_uri","fname","wlansd_map","push","wlanItemsToAdd","inserted","wlanItemsToDelete","deleted","FlashAirApp.notifyUpdate","count","nav","clearInterval","timer","FlashAirApp.addItem","img","div","closest","container","css","FlashAirApp.onLayoutComplete","FlashAirApp.startImageLoading","FlashAirApp.getIconClass","ready","itemSelector","layoutMode","mansory","columnWidth","getSortData","name","itemElem","datetime","fdate","ftime","isInitLayout","initializeApp","gallery","on","clickedA","items","filteredItems","psItems","startIndex","length","item","psitem","src","client","GetFileUrl","msrc","Thumbnail","GetUrl","w","get","naturalWidth","h","naturalHeight","getElementById","history","shareEl","index","init"],"mappings":"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","file":"flashAir-sd-all.js","sourcesContent":[null,"/**\r\n * Yokin's FlashAir Javascript client library\r\n * (c) 2015 Yokinsoft Jake.Y.Yoshimura http://www.yo-ki.com\r\n *\r\n * @version 0.9.4\r\n * @author Yokinsoft Jake.Y.Yoshimura http://www.yo-ki.com\r\n * @license MIT License\r\n */\r\n/// <reference path=\"../typings/jquery/jquery.d.ts\" />\r\n\r\n/// <reference path=\"flashAirClient.d.ts\" />\r\n/// <reference path=\"ral.d.ts\" />\r\n\r\nmodule FlashAir\r\n{\r\n\t/*\r\n    export interface localStorageHandler {\r\n        selectLocalHomeDirectory(silent: boolean, forceToSelect: boolean): JQueryPromise<any>;\r\n        listFiles( directoryEntry : Array<any>, callback : Function );\r\n\t\tlocalHomeDirectoryEntry : any;\r\n    }*/\r\n\t    /**\r\n     * internal use only. extra info  for each fileinfo\r\n     */\r\n    export interface FileInfoRawEx extends FileInfoRaw {\r\n         _dom?: any;\r\n         _syncStatus?: SyncStatus;\r\n         _xhr?: XMLHttpRequest;\r\n         _checked? : boolean;\r\n    }\r\n\t\r\n\texport enum SyncScheme {\r\n\t\tSyncAll = 1,\r\n\t\tSyncNewOnes = 2\r\n\t}\r\n\texport enum SyncMode {\r\n\t\tNone,\r\n\t\tMonitoring\r\n\t}\r\n\texport enum QueueStatus\r\n\t{\r\n\t\tEmpty = 1,\r\n\t\tQueued = 2\r\n\t} \r\n\texport enum SyncStatus {\r\n\t\tNone,\r\n\t\tQueued,\r\n\t\tSyncing,\r\n\t\tSynced,\r\n\t\tError\r\n\t}\r\n\tenum DirectoryStatus {\r\n\t\tDone,\r\n\t\tPending,\r\n\t\tRunning\r\n\t}\r\n\t/*class Directory {\r\n\t\tPath: string;\r\n\t\tName : string;\r\n\t\t\r\n\t}*/\r\n\texport class FlashAirSynchronizer extends eventEmitter\r\n\t{\r\n\t\tlocalHomeDirectoryEntry  = null;\r\n\t\t//dirList: Array<Directory>;\r\n\t\t_queue: SyncQueue;\r\n\t\tfa: FlashAirClient;\r\n        //protected fileStorage: localStorageHandler;\r\n\t\tlastSyncChecked : Date = new Date();\r\n\t\tsyncScheme : SyncScheme = SyncScheme.SyncAll;\r\n\t\tsyncMode : SyncMode = SyncMode.None;\r\n\t\tqueueStatus : QueueStatus = QueueStatus.Empty;\r\n\t\t\r\n        constructor(fa: FlashAirClient ){\r\n\t\t\tsuper();\r\n\t\t\tthis.fa = fa;\r\n            //this.fileStorage = fileStorage;\r\n\t\t\tthis._queue = new SyncQueue();\r\n\t\t\t//this.dirList = new Array<Directory>();\r\n\t\t}\r\n\r\n\r\n\t\tselectLocalHomeDirectory(silent :boolean = false, forceToSelect : boolean = false ) : JQueryPromise<any>\r\n\t\t{\r\n\t\t\tthrow \"not implemented\";\r\n            //return this.fileStorage.selectLocalHomeDirectory(silent, forceToSelect);\r\n\t\t}\t\r\n\r\n    \tfileListUpaded( list : FileInfoRaw [], listAdded : FileInfoRaw [], listDeleted : FileInfoRaw [], scheme? : SyncScheme  )\r\n\t\t{\r\n\t\t\tthrow \"not implemented\";\r\n\t\t}\r\n\t\t//\r\n\t\t// Queue control\r\n\t\t//\t\t\r\n\t\tprivate runningItem : FileInfoRaw;\r\n\t\tstartMonitoring(){\r\n\t\t\tif( this.syncMode == SyncMode.None ){\r\n\t\t\t\tthis.syncMode = SyncMode.Monitoring;\r\n\t\t\t\tthis.startNext();\r\n\t\t\t}\r\n\t\t}\r\n\t\tstopMonitoring(){\r\n\t\t\tthis.syncMode = SyncMode.None;\r\n\t\t}\r\n\t\tstart( mode? : SyncMode ) : boolean {\r\n\t\t\tvar started = this.startNext();\r\n\t\t\tif( started ){\r\n\t\t\t\tthis.trigger(\"fa.sync.queue\",\"started\")\r\n\t\t\t}\r\n\t\t\treturn started;\r\n\t\t}\r\n\t\tstop() : void {\r\n\t\t\tthis.syncMode = SyncMode.None;\r\n\t\t\tthis.unqueue(null); // cancell all;\r\n\t\t}\r\n\t\tstartNext() : boolean {\r\n\t\t\tvar me = this;\r\n\t\t\tif( ! me.runningItem ){\r\n\t\t\t\tvar faItem : FileInfoRawEx = this._queue.next();\r\n\t\t\t\tif( faItem ){\r\n\t\t\t\t\tme.runningItem = faItem;\r\n\t                me.trigger(\"fa.sync.start\", faItem );\r\n\t\t\t\t\tfaItem._syncStatus = SyncStatus.Syncing;\r\n\t\t\t\t\tme.fa.pausePolling();\r\n\t                this.downloadFile( faItem )\r\n\t                    .progress( function(loaded, total ){\r\n\t                        me.trigger(\"fa.sync.progress\", faItem, loaded, total );\r\n\t                    })\r\n\t                    .done(function(__fileEntry__){\r\n\t                        faItem._syncStatus = SyncStatus.Synced;\r\n\t                        me.trigger(\"fa.sync.done\", faItem );\r\n\t                    })\r\n\t\t\t\t\t\t.fail(function(e){\r\n\t\t\t\t\t\t\tfaItem._syncStatus = SyncStatus.Error;\r\n\t                        me.trigger(\"fa.sync.done\", faItem );\r\n\t\t\t\t\t\t})\r\n\t                    .always(function(){\r\n\t\t\t\t\t\t\tme.runningItem = null;\r\n\t\t\t\t\t\t\tme.fa.resumePolling();\r\n\t               \t\t  \tme.start(); \r\n\t                    });\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tme.trigger(\"fa.sync.queue\",\"empty\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tqueue( item : FileInfoRaw, autoStart : boolean = false )\r\n\t\t{\r\n\t\t\tvar status = (<FileInfoRawEx>item)._syncStatus;\r\n\t\t\t(<FileInfoRawEx>item)._syncStatus = SyncStatus.Queued;\r\n\t\t\tthis._queue.add( item );\r\n\t\t\tif( autoStart ){\r\n\t\t\t\tif( !this.start() ){\r\n\t\t\t\t\tthis.trigger('fa.sync.queued', item );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tunqueue( _item : FileInfoRaw, forciblyAbort : boolean = true ){\r\n\t\t\tvar item = <FileInfoRawEx>_item;\r\n\t\t\tvar removed = false, stopped = false;\r\n\t\t\tif( item ){\r\n\t\t\t\tvar status = item._syncStatus;\r\n\t\t\t\tremoved = this._queue.remove( item ), stopped = false;\r\n\t\t\t\tif( forciblyAbort && item._xhr ){\r\n                    (item._xhr.abort || item._xhr[\"cancel\"])(); delete item._xhr;\r\n\t\t\t\t\t if( this.runningItem == item ){\r\n\t\t\t\t\t\t this.runningItem = null;\r\n\t\t\t\t\t }\r\n\t\t\t\t\t stopped = true;\r\n\t\t\t \t}\r\n\t\t\t\titem._syncStatus = SyncStatus.None;\r\n\t\t\t\tif( removed || stopped){\r\n\t\t\t\t\tthis.trigger(\"fa.sync.unqueued\", item );\r\n\t\t\t\t\tif( this._queue.list.length == 0 ){\r\n\t\t\t\t\t\tthis.trigger(\"fa.sync.queue\", \"empty\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\twhile( this._queue.list.length > 0 ){\r\n\t\t\t\t\tthis.unqueue(this._queue.list[ this._queue.list.length-1]);\r\n\t\t\t\t}\r\n\t\t\t\tif( this.runningItem ) this.unqueue(this.runningItem);\r\n\t\t\t\t// cancel all\r\n\t\t\t}\r\n\t\t}\r\n\t\tprotected downloadFile( faItem : FileInfoRaw ) : JQueryPromise<any>\r\n\t\t{\r\n\t\t\tthrow \"not implemented\";\r\n\t\t}\r\n\r\n\t}\r\n\tclass SyncQueue \r\n\t{\r\n\t\tlist : FileInfoRaw[] = [];\r\n\t\tnext() : FileInfoRaw {\r\n\t\t\treturn this.list.shift();\r\n\t\t}\r\n\t\tadd( item :FileInfoRaw ){\r\n\t\t\tthis.list.push(item);\r\n\t\t}\r\n\t\tremove( item : FileInfoRaw ) : boolean{\r\n\t\t\tvar removed = false;\r\n\t\t\tfor( var i=0; i<this.list.length; i++ ){\r\n\t\t\t\tvar _item = this.list[i];\r\n\t\t\t\tif( _item.r_uri == item.r_uri && _item.fname == item.fname ){\r\n\t\t\t\t\tthis.list.splice(i,1);\r\n\t\t\t\t\tremoved = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn removed;\r\n\t\t}\r\n\t}\t\r\n}\r\n","/**\r\n * Browser customization (List.htm) for FlashAir(TM) TOSHIBA\r\n * (c) 2015 Yokinsoft http://www.yo-ki.com\r\n * \r\n * @author Yokinsoft Jake.Y.Yoshimura http://www.yo-ki.com\r\n * @license MIT License\r\n */\r\n\r\n///<reference path=\"flashAirClient.d.ts\" />\r\n///<reference path=\"flashAirSynchronizer.ts\" />\r\n//<reference path=\"./yokins-fa-app.ts\" />\r\n\r\nvar PhotoSwipe, PhotoSwipeUI_Default;\r\nvar filesize;\r\nvar moment;\r\n\r\ninterface JQuery {\r\n    isotope;\r\n}\r\n\r\nvar is_chrome_app = document.location.protocol == \"chrome-extension:\";\r\nvar is_ms_app = document.location.protocol == \"ms-appx:\";\r\nvar is_app = is_chrome_app || is_ms_app;\r\n\r\nvar wlansd : FlashAir.FileInfoRaw[]; // provided in List.htm otherwise undefined\r\n\r\nvar faClient;\r\n\r\n\r\nclass FlashAirApp\r\n{\r\n    private baseUrl : string;\r\n    client : FlashAir.FlashAirClient;\r\n    protected dir : string;\r\n    protected lazyLoading : boolean = true;\r\n    protected wlansd_map = {};\r\n    private template = $(\"#itemTeamplte\").html();\r\n    protected grid : any;\r\n    protected singlePageNavigation = false;\r\n    protected hashDir = /DIR=([^&]*)/;\r\n    constructor( options : { host: string;  dir:string; singlePage?: boolean }){\r\n       var me = this;\r\n        me.singlePageNavigation = typeof options.singlePage == 'undefined' ? is_app : !!options.singlePage;\r\n        me.baseUrl = options.host || \"\";\r\n        if (me.baseUrl.lastIndexOf(\"/\") == me.baseUrl.length - 1) {\r\n            me.baseUrl = me.baseUrl.substring(0, me.baseUrl.length - 1 );\r\n        }\r\n        faClient = me.client = new FlashAir.FlashAirClient(me.baseUrl, {\r\n            pollingInterval: 2000\r\n        });\r\n        me.client\r\n            .on('fa.hostchanged', function(){\r\n                //me.refreshList([], false );\r\n                me.onHostChanged();\r\n            })\r\n            .on(\"fa.hostready\", function(){\r\n                me.onHostReady();\r\n            })\r\n            .on(\"fa.polling\", function(status){\r\n                me.pollingStatusChanged(status);\r\n            })\r\n            .on(\"fa.updated\", function(){\r\n                me.actionRefresh(false);\r\n            });\r\n\r\n        $(\"#hostUrl\").text(me.baseUrl || document.location.host);\r\n        me.dir = options.dir;\r\n\r\n        me.grid = $(\"#grid\");\r\n        me.grid.isotope('on', 'layoutComplete', $.proxy( me.onLayoutComplete, me ));\r\n\r\n        if (me.lazyLoading) {\r\n            var _timeout;\r\n            $(window).on(\"scroll.fa resize.fa lookup.fa\", function () {\r\n                clearTimeout(_timeout);\r\n                _timeout = setTimeout(function () {\r\n                    me.recalcImageLoading();\r\n                }, 120);\r\n            });\r\n        }\r\n        me.initHost();\r\n        me.initUi();\r\n        me.oninit();\r\n    }\r\n    /**\r\n     * globally called for App initialization.\r\n     * Each app, (chrome, winstore...) must override this method. \r\n     */\r\n    static initializeApp(){\r\n        fa = new FlashAirApp({ host: \"\", dir : document.location.pathname, singlePage: true });\r\n    }\r\n    initHost()\r\n    {\r\n        \r\n    }\r\n    initUi(){\r\n        var me = this;\r\n        // sort menu handling\r\n        $(\"#menuSort\").on(\"click\",\"button\", function(){\r\n            var btn = $(this);\r\n            var menu = btn.parent();\r\n            var sortAscending = btn.hasClass(\"active\") ? !menu.data(\"sortascending\") : true;\r\n            me.grid.isotope({ sortBy: btn.data(\"sort\"), sortAscending: sortAscending });\r\n            menu.data(\"sortascending\", sortAscending);\r\n            $(\"button\",menu).removeClass('active');\r\n            btn.addClass(\"active\");\r\n        });\r\n        \r\n        //\r\n        if( me.singlePageNavigation )\r\n        {\r\n            $(document).on('click', 'a.dir-nav[href]', function (e) {\r\n                var a = $(this);\r\n                var href = a.attr('href');\r\n                me.navigate(href);\r\n                e.preventDefault();\r\n                return false;\r\n            });\r\n            $(window).on('hashchange', function(){\r\n                var m = me.hashDir.exec( location.hash );\r\n                if( m ){\r\n                    console.log( 'navigated to ' + m[1] );\r\n                    me.navigate( m[1], false );\r\n                } else if( ! location.hash ){\r\n                    me.navigate( \"/\" , false );\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * \r\n     */\r\n    protected onHostChanged()\r\n    {\r\n        console.log('onhostchanged');\r\n        this.clearList();\r\n        wlansd = undefined;\r\n        this.dir = \"/\";\r\n    }\r\n    protected onHostReady()\r\n    {\r\n        console.log('onhostready');\r\n        moment.locale( this.client.lang );\r\n        if ( typeof wlansd != 'undefined' ) {\r\n            this.addItem(wlansd, \"insert\");\r\n            this.grid.isotope('layout');\r\n        } else { // Chrome App version?\r\n            wlansd = [];\r\n            var m = this.hashDir.exec(location.hash) || (is_app ? ['', this.dir || '/'] : /(.*[^\\/])\\/?$/.exec(location.pathname) );\r\n            this.dir = m ? m[1] : location.pathname;\r\n            this.actionRefresh(false);\r\n        }\r\n    }\r\n    oninit(){\r\n    }\r\n    protected pushHistory( dir : string )\r\n    {\r\n        history.pushState(null, null, \"#DIR=\" + dir );\r\n    }\r\n    navigate( dir : string, pushHistory : boolean = true )\r\n    {\r\n        var me = this;\r\n        me.dir = dir;\r\n        me.clearList();\r\n        me.actionRefresh(true);\r\n        if( pushHistory ) me.pushHistory(dir);\r\n        //me.setWindowTitle(dir);\r\n    }\r\n    recalcImageLoading(){\r\n        var me = this;\r\n        var w = $(window);\r\n        var wt = w.scrollTop(), wb = wt + w.height();\r\n        var margin = Math.abs(wb-wt)/2;\r\n        me.startImageLoading(\r\n            $( me.grid.data('isotope').filteredItems.map(function(el){ return el.element;}))\r\n            //$(\".grid-item\", me.grid )\r\n            .filter(function(i){\r\n                var el = $(this);\r\n                var et = el.offset().top, eb = et + el.height();\r\n                return !el.is(\":hidden\") &&  el.find(\"img\").data(\"src\") && ( eb >= wt - margin && et <= wb + margin ); \r\n            })\r\n        );\r\n          \r\n    }\r\n    setWindowTitle(text) {\r\n        var me = this;\r\n        $(\"#remotePathText\").text(text);\r\n        // setup moveup link\r\n        if ( me.dir && me.dir != \"/\" ) {\r\n            var upLink = me.dir.substring(0, me.dir.lastIndexOf(\"/\")) || \"/\";\r\n            $(\"#moveUpLink\").removeAttr(\"disabled\").attr(\"href\", upLink).show();\r\n        } else {\r\n            $(\"#moveUpLink\").attr(\"disabled\" ,\"disabled\");\r\n        }\r\n\r\n    }\r\n    pollingStatusChanged(status) {\r\n        var indicator = $(\"#connectionIndicator\");\r\n        switch(status){\r\n            case \"connecting\":\r\n                indicator.removeClass(\"connected\").addClass(\"connecting\");\r\n                break;\r\n            case \"connected\":\r\n                indicator.removeClass(\"connecting\").addClass(\"connected\");\r\n                break;\r\n        }\r\n    }\r\n    actionRefresh (isNavigation : boolean ) {\r\n        var me = this, dir = me.dir;\r\n        me.client.Command.FileList( dir )\r\n        .done(function (list) {\r\n            me.setWindowTitle( dir);\r\n            me.refreshList(list, isNavigation );\r\n        });\r\n    }\r\n\r\n    onListUpdated(listAll : FlashAir.FileInfoRaw[], listAdded : FlashAir.FileInfoRaw[], listDeleted : FlashAir.FileInfoRaw[])\r\n    {\r\n        \r\n    }\r\n    private deleteItemFromList( item : FlashAir.FileInfoRawEx)\r\n    {\r\n        var me = this;\r\n        me.grid.isotope('remove', item._dom);\r\n        var dom = item._dom;\r\n        delete item._dom;\r\n        delete me.wlansd_map[item.r_uri + \"/\" + item.fname];\r\n        if (dom) {\r\n            $(dom).removeData(\"fa-item\").remove();\r\n        }\r\n    }\r\n    clearList() {\r\n        var me = this;\r\n        if (wlansd) {\r\n            $.each(wlansd, function (index, i: FlashAir.FileInfoRaw) {\r\n                me.deleteItemFromList(i);\r\n            });\r\n            wlansd.length = 0;\r\n        }\r\n    }\r\n    refreshList(list : FlashAir.FileInfoRaw[] , suppressNotification : boolean) {\r\n        var deleted = 0, inserted = 0;\r\n        var me = this, wlansd_map = me.wlansd_map;\r\n        var wlanItemsToAdd = [], wlanItemsToDelete = [];\r\n        $.each( wlansd, function(index, i:FlashAir.FileInfoRawEx ) { i._checked = false;} );\r\n        $.each(list, function(index, i) {\r\n            var key = i.r_uri + \"/\" + i.fname;\r\n            if (key in wlansd_map) {\r\n                // exixting\r\n                wlansd_map[key]._checked = true;\r\n            } else {\r\n                // newly added\r\n                wlansd.push(i);\r\n                wlanItemsToAdd.push(i);\r\n                inserted++;\r\n            }\r\n        });\r\n        $.each(wlansd, function (index, i: FlashAir.FileInfoRawEx ) {\r\n            if (i._checked === false) {\r\n                // deleted...\r\n                wlanItemsToDelete.push(i);\r\n                me.deleteItemFromList(i);\r\n                deleted++;\r\n            }\r\n        });\r\n        // delete from wlansd array\r\n        for (var i = wlansd.length - 1; i >= 0; i--) {\r\n            if (  (<FlashAir.FileInfoRawEx>wlansd[i])._checked === false) {\r\n                wlansd.splice(i, 1);\r\n            }\r\n        }\r\n        if (wlanItemsToAdd.length > 0) {\r\n            me.addItem(wlanItemsToAdd, \"insert\");\r\n            inserted = wlanItemsToAdd.length;\r\n        }\r\n        if ( inserted || deleted ) {\r\n            me.grid.isotope(\"layout\");\r\n            if (suppressNotification !== true){\r\n                me.notifyUpdate();   \r\n            }\r\n            this.onListUpdated( wlansd, wlanItemsToAdd, wlanItemsToDelete );\r\n        }\r\n    }\r\n    notifyUpdate () {\r\n        var nav = $(\"body nav.navbar\");\r\n        var count = 6;\r\n        var timer = setInterval(function () {\r\n            if (count % 2 == 0) {\r\n                nav.removeClass(\"navbar-default\").addClass(\"navbar-inverse\");\r\n            } else {\r\n                nav.removeClass(\"navbar-inverse\").addClass(\"navbar-default\");\r\n            }\r\n            if (--count <= 0) { clearInterval(timer);}\r\n        }, 200);\r\n    }\r\n    addItem( _items : FlashAir.FileInfoRaw[] | FlashAir.FileInfoRaw , method : string )\r\n    {\r\n        var me = this;\r\n        var wlansd_map = me.wlansd_map;\r\n        var grid = me.grid;\r\n\r\n        var items : FlashAir.FileInfoRawEx[] = $.isArray(_items) ? <FlashAir.FileInfoRawEx[]>_items : <FlashAir.FileInfoRawEx[]> [_items];\r\n\r\n        var iso_items_to_add = [];\r\n        for (var _i = 0 ; _i < items.length; _i++) {\r\n            var item = items[_i];\r\n            wlansd_map[item.r_uri + \"/\" + item.fname] = item;\r\n            var div = $(me.template);\r\n            div.data(\"fa-item\", item);\r\n            grid.append(div);\r\n\r\n            item._dom = div;\r\n\r\n            var a = div.find(\"a\")\r\n                .attr(\"data-title\", item.fname)\r\n                .attr(\"href\", item.r_uri + \"/\" + item.fname)\r\n                .attr(\"title\", moment( FlashAir.FileInfo.FTIMEtoDateTime(item.fdate, item.ftime) ).format(\"LLLL\", me.client.lang ) );\r\n            if( is_chrome_app) a.attr(\"target\", \"_blank\");\r\n            if (item.attr & 16) a.addClass(\"dir-nav\");\r\n            var container = div.find('.image-container');\r\n            div.find(\"div.name-label\").text(item.fname + (item.fsize ? \" (\" + filesize(item.fsize) + \")\" : \"\"));\r\n            container.addClass(fa.getIconClass(item));\r\n            iso_items_to_add.push(div.get(0));\r\n            if ( container.hasClass(\"icon-photo\") ) {\r\n                div.hide();\r\n                var img = div.find(\"img\");\r\n                img.on('load',  function (){\r\n                    var img = $(this);\r\n                    var div = img.closest(\".grid-item\");\r\n                    var container = div.find('.image-container');\r\n                    if (is_chrome_app) {\r\n                        container.css(\"background-image\", img.css(\"background-image\")).css(\"background-size\", \"cover\");\r\n                    } else container.css(\"background-image\", \"url('\" + img.attr('src') + \"')\").css(\"background-size\", \"cover\");\r\n                });\r\n                var imgSrc = me.client.Thumbnail.GetUrl( item );\r\n                img.data(\"src\", imgSrc);\r\n            }\r\n        }\r\n        //this.onListUpdated();\r\n        if (iso_items_to_add.length > 0) {\r\n            grid.isotope( ( method || \"appended\"), iso_items_to_add);\r\n           // me.recalcImageLoading();\r\n        }\r\n    }\r\n    onLayoutComplete(laidOutitems)\r\n    {\r\n        var me = this;\r\n        if( me.lazyLoading) me.recalcImageLoading();\r\n        else me.startImageLoading( laidOutitems.map( function(e){ return e.element;}) );\r\n    }\r\n    startImageLoading(laidOutitems)\r\n    {\r\n        for (var i = 0; i < laidOutitems.length; i += 1) {\r\n            var img = $(laidOutitems[i]).find(\"img\");\r\n            if (!img.attr(\"src\") && img.data(\"src\")) {\r\n                img.attr(\"src\", img.data(\"src\"));\r\n                img.removeData(\"src\");\r\n            }\r\n        }\r\n    }\r\n    \r\n    \r\n    getIconClass(item)\r\n    {\r\n        var fname = item.fname;\r\n        if ((item.attr & 16) && fname == \"DCIM\") icon = \"icon-dcim\";\r\n        else if (item.attr & 16) icon = \"icon-folder\";\r\n        else {\r\n            var ext_lc = fname.substring(fname.lastIndexOf(\".\") + 1).toLowerCase();\r\n            var icon;\r\n            if ((ext_lc == \"mov\") || (ext_lc == \"avi\") || (ext_lc == \"mpg\") || (ext_lc == \"mpeg\") || (ext_lc == \"mp4\") || (ext_lc == \"wmv\") || (ext_lc == \"rm\")) {\r\n                icon = \"icon-movie\";\r\n            }\r\n            else if ((ext_lc == \"mp3\") || (ext_lc == \"wma\") || (ext_lc == \"aac\") || (ext_lc == \"wav\") || (ext_lc == \"aiff\")) {\r\n                icon = \"icon-song\";\r\n            }\r\n            else if ((ext_lc == \"gif\") || (ext_lc == \"bmp\") || (ext_lc == \"png\") || (ext_lc == \"jpg\") || (ext_lc == \"jpeg\") ) {\r\n                icon = \"icon-photo\";\r\n            }\r\n            else if (ext_lc == \"txt\") {\r\n                icon = \"icon-text\";\r\n            }\r\n            else if ( is_app && ext_lc == \"dng\") {\r\n                icon = \"icon-dng\";\r\n            }\r\n            else if (  is_app && ( ext_lc == \"cr2\" || ext_lc == \"crw\" || ext_lc == \"raw\" || ext_lc == \"erf\" || ext_lc == \"raf\" || ext_lc == \"3fr\" || ext_lc == \"arw\" || ext_lc == \"kdc\" || ext_lc == \"dcr\" || ext_lc == \"mrw\" || ext_lc == \"iiq\" || ext_lc == \"mos\" || ext_lc == \"mef\" || ext_lc == \"mfw\" || ext_lc == \"nef\" || ext_lc == \"nrw\" || ext_lc == \"orf\" || ext_lc == \"raw2\" || ext_lc == \"pef\" || ext_lc == \"tif\" || ext_lc == \"srw\" || ext_lc == \"x3f\" || ext_lc == \"sr2\" )) {\r\n                icon = \"icon-raw\";\r\n            }\r\n            else {\r\n                icon = \"icon-other\";\r\n            }\r\n        }\r\n        return icon;\r\n    }\r\n}\r\n\r\nvar fa : FlashAirApp;\r\n\r\n$(document).ready(function () {\r\n    var grid = $('#grid');\r\n    grid.isotope({\r\n        // options\r\n        itemSelector: '.grid-item',\r\n        layoutMode: 'fitRows',\r\n        mansory: {\r\n            columnWidth: 50\r\n        },\r\n        getSortData: {\r\n            name: function(itemElem){\r\n                var el = $(itemElem);\r\n                var i = el.data('fa-item');\r\n                return i.fname;\r\n            },\r\n            datetime: function(itemElem){\r\n                var el = $(itemElem);\r\n                var i = el.data('fa-item');\r\n                return ( i.fdate << 15 ) | i.ftime;\r\n            }\r\n        },\r\n        sortBy: 'datetime',\r\n        sortAscending: false,\r\n        isInitLayout: false\r\n    });\r\n\r\n\r\n    //\r\n    // activate FlashAirApp\r\n    //\r\n    FlashAirApp.initializeApp(); // call static function, which is overriedn by each App's purpose.\r\n\r\n    //\r\n    // PhotoSwipe\r\n    //\r\n    var gallery;\r\n    if( ! is_chrome_app ){\r\n        grid.on(\"click\", \"div.grid-item a .icon-photo\", function (e) {\r\n            e.preventDefault();\r\n            var clickedA = $(this).closest(\"a\");\r\n            // open photoswipe\r\n            var items = grid.data('isotope').filteredItems;\r\n            var psItems = []; var startIndex = 0;\r\n            for (var i = 0; i < items.length; i++ )\r\n            {\r\n                var item = items[i];\r\n                var div = $(item.element);\r\n                if (div.find(\".image-container.icon-photo\").length > 0) {\r\n                    var data = div.data(\"fa-item\");\r\n                    var img = div.find(\"img\");\r\n                    var a = div.find(\"a\");\r\n                    var psitem = {\r\n                        src: fa.client.GetFileUrl( data ),\r\n                        msrc: fa.client.Thumbnail.GetUrl(data),\r\n                        w: (<HTMLImageElement> img.get(0)).naturalWidth * 10,\r\n                        h: (<HTMLImageElement> img.get(0)).naturalHeight * 10\r\n                    };\r\n                    if (!psitem.w || !psitem.h) { psitem.h = 900; psitem.w = 900; }\r\n                    psItems.push(psitem);\r\n                    if (psitem.src == clickedA.attr('href')) {\r\n                        startIndex = psItems.length - 1;\r\n                    }\r\n                }\r\n            }\r\n            gallery = new PhotoSwipe(document.getElementById(\"pswp\"), PhotoSwipeUI_Default, psItems, {\r\n                history: false, shareEl: false,\r\n                index: startIndex\r\n                \r\n            });\r\n            gallery.init();\r\n            return false;\r\n        });\r\n    }\r\n});"],"sourceRoot":"/source/"}